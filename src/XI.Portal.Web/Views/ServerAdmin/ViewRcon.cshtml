@using XI.Portal.Web.Extensions
@model XI.Portal.Servers.Dto.GameServerDto

@{
    ViewData["Title"] = "Rcon - " + Html.ServerName(Model.Title, null);
}

    <div class="wrapper wrapper-content animated fadeInRight">

        <div class="alert alert-warning" role="alert">
            <i class="fa fa-info-circle"></i> THIS FEATURE IS CURRENTLY UNDER DEVELOPMENT AND IS EXPERIMENTAL
        </div>

        <row class="row">
            <div class="col-12">

                <div class="container-fluid">
                    <div class="ibox">
                        <div class="ibox-title">
                            @ViewData["Title"]
                        </div>
                        <div class="ibox-content">
                            <table id="dataTable">
                                <thead>
                                    <tr>
                                        <th>
                                            #
                                        </th>
                                        <th>
                                            Username
                                        </th>
                                        <th>
                                            Guid
                                        </th>
                                        <th>
                                            Ip Address
                                        </th>
                                        <th>
                                            Score
                                        </th>
                                        <th>
                                            Rate
                                        </th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </row>

    </div>

@* ReSharper disable once Razor.SectionNotResolved *@

@section Scripts {

    <script type="text/javascript">

        $(document).ready(function() {

            $('#dataTable').DataTable({
                processing: true,
                pageLength: 50,
                stateSave: true,
                order: [[0, "asc"]],
                ajax: {
                    url: '/ServerAdmin/GetRconPlayers/@Model.ServerId',
                    dataSrc: 'data',
                    error: handleAjaxError
                },
                columns: [
                    {
                        data: 'num',
                        name: 'num',
                        sortable: true
                    },
                    {
                        data: 'name',
                        name: 'name',
                        sortable: true,
                        render: function(data, type, row) {
                            return escapeHtml(row['name']);
                        }
                    },
                    {
                        data: 'guid',
                        name: 'guid',
                        sortable: false
                    },
                    {
                        data: 'ipAddress',
                        name: 'ipAddress',
                        sortable: false
                    },
                    {
                        data: 'score',
                        name: 'score',
                        sortable: true
                    },
                    {
                        data: 'rate',
                        name: 'rate',
                        sortable: false
                    },
                    {
                        sortable: false,
                        render: function(data, type, row) {
                            return "";
                            @*return '<a href="/ServerAdmin/KickPlayer/@Model.ServerId?num=' + row['num'] + '">Kick Player</a> | <a href="/ServerAdmin/BanPlayer/' + row['num'] + '">Ban Player</a>';*@
                        }
                    }
                ]
            });
        });

        setInterval(function() {
                $('#dataTable').DataTable().ajax.reload();
            },
            20000);

    </script>
}